
----------------------------------------------------------------------------------------DAY 1-----------------------------------------------------------------------------------------------------------

COSC NOTES 
I am Stack #9
Stack#9 IP:
10.50.27.51

US ARMY CYBER SCHOOL:
http://10.50.22.197:8000

Username: KAEL-M-24-503
Password: Carmel123!

Class name: M24503
Password: password






xfreerdp /u:student /v:10.50.27.51 /dynamic-resolution +glyph-cache +clipboard

ssh student@10.50.27.51


Windows_PowerShell_Regex_5
Count the number of words in words.txt that meet the following criteria:

    a appears at least twice consecutively
    and is followed immediately by any of the letters a through g
    Note: File Location - C:\Users\CTF\Desktop\CTF
    Example: aac...aaa...


Get-Content C:\Users\CTF\Desktop\words.txt | Where-Object {$_ -Match 'aa[a-g]'} | Measure-Object




Windows_PowerShell_Profiles6


What command would you run to view the help for PowerShell Profiles?


Get-Help about_Profiles






Windows_PowerShell_Profiles7

What command would tell you if there was a profile loaded for All Users All Hosts?

Flag is the full command syntax


Test-Path $PROFILE.AllUsersAllHosts





Windows_PowerShell_Profiles8

Challenge only allows ONE attempt

Malware is running on the primary PowerShell profile on the File-Server. Based on PowerShell profile order of precedence (what is read first), find the correct flag.

The flag is the string after the #, without the preceding space.




$Profile | Get-Member -MemberType NoteProperty

Get-Content $Profile.AllUsersAllHosts



Use a PowerShell loop to unzip the Omega file 1,000 times and read what is inside.

Note: Make sure you back up the .zip file to a different directory before attempting this challenge.

$counter = 1000
do{$file = 'omega' + $counter + ".zip"; expand-archive $file -DestinationPath <filepath>; $counter -- }until($counter -eq 0)

do{$file = 'omega' + $counter + ".zip"; expand-archive $file -DestinationPath C:\Use
rs\CTF\Documents\; $counter -- }until($counter -eq 0)

------------------------------------------------------------------------------------------DAY 2------------------------------------------------------------------------------------------------------------------
Get-WmiObject win32_useraccount | fl -Property name, sid

Primer_Registry_1
What Windows registry path is the Volatile Hive?
HKLM\HARDWARE




Primer_Registry_2
What registry key creates the Wow6432Node to represent 32-bit applications that run on a 64-bit version of Windows?

HKEY_LOCAL_MACHINE\SOFTWARE



Primer_Registry_3
In what registry path are the BOOT_START drivers located?
HKLM\SYSTEM\CurrentControlSet\Services


Primer_Registry_4
What start value do BOOT_START drivers have in the registry?
0x0



Primer_Registry_5
During kernel initialization, what registry location is read containing all SYSTEM_START drivers?
HKLM\SYSTEM\CurrentControlSet\Services


Primer_Registry_6
SERVICE_AUTO_START drivers and services are loaded after kernel initialization. What start value do they have in the registry?
0x2


Primer_Registry_7
What start value do SERVICE_DEMAND_START drivers and services have in the registry?
0x3


Primer_Registry_8
When accessing a remote registry which are the only 2 accessible HKEYs?

SYNTAX Hive, Hive
HKLM, HKU



Primer_Registry_9
What PowerShell cmdlet will list currently mapped drives?
Get-PSDrive



Primer_Registry_10
What is the native Windows GUI tool for managing the registry?
regedit


Windows_Registry_Basics_1
What registry hive contains all machine settings?
HKLM



Windows_Registry_Basics_2
What registry hive contains all user settings?
HKU

Windows_Registry_Basics_3
What registry hive contains only the currently logged-in user's settings?
HKCU


Windows_Registry_Basics_4
The HKEY_CURRENT_USER registry hive is a symbolic link to another registry subkey. What is the subkey that it is linked to?

Flag format: HIVE\SID.........................

Reminder: All challenges are done using Workstation2.
LOOK AT MAP FOR REMINDER WHO TO SSH IN AS. IN THIS CASE IT WANTS andy.dwyer
 
HKU\S-1-5-21-2881336348-3190591231-4063445930-1004


Windows_Registry_Basics_5
What PowerShell command will list all the subkeys and contents in the current directory and/or will list all the subkeys and the contents of a directory you specify?

Get-ChildItem





Windows_Registry_Basics_6
What PowerShell command will list only the contents of a registry key or subkey?
Get-Item


Windows_Registry_Basics_7
What registry subkey runs every time the machine reboots? The flag is the full path, using PowerShell.
HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUN



Windows_Registry_Basics_8
What registry subkey runs every time a user logs on? The flag is the full path, using PowerShell.

Flag format: FULL\PATH\ALL\CAPS


HKEY_CURRENT_USER\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUN





Windows_Registry_Basics_9
What registry subkey runs a single time, then deletes its value once the machine reboots? The flag is the full path, using PowerShell.

Flag format: FULL\PATH\ALL\CAPS




HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUNONCE



Windows_Registry_Basics_10

What registry subkey runs a single time, then deletes its value when a user logs on? The flag is the full path, using PowerShell.

Flag format: FULL\PATH\ALL\CAPS

HKEY_CURRENT_USER\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUNONCE




Windows_Registry_Basics_11

What is the suspicious value inside of the registry subkey from your previous challenge named registry_basics_7?

reg query HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUN

C:\malware.exe








Windows_Registry_Basics_12

What is the suspicious value inside of the registry subkey that loads every time the "Student" user logs on?

HKEY_CURRENT_USER\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUN
C:\botnet.exe







Windows_Registry_Basics_13

What is the value inside of the registry subkey from registry_basics_9?

reg query HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUNONCE
C:\virus.exe






Windows_Registry_Basics_14

What is the value inside of the registry subkey that loads a single time when the "student" user logs on?

reg query HKEY_CURRENT_USER\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUNONCE
C:\worm.exe


Windows_Registry_Basics_15

Figure out the manufacturer's name of the only USB drive that was plugged into this machine.
reg query HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Enum\USBSTOR

SanDisk9834





Windows_Registry_Basics_16

What suspicious user profile, found in the registry, has connected to this machine?



Windows_Registry_Basics_17

What suspicious wireless network, found in the registry, has this system connected to?





Primer_NTFS_1

The ____ determines how the data is stored on disk.

(Fill in the blank)
File System






Primer_NTFS_2
What are NTFS partition sectors grouped into?
Clusters



Primer_NTFS_3
What contains the metadata about all of the files and directories on a NTFS partition?
Master File Table



Primer_NTFS_4
NTFS files are collections of what?
attributes




Primer_NTFS_5
Which NTFS attribute would store an alternate data stream?
$DATA




Primer_NTFS_6
Which NTFS attribute holds information about a file's encrypted attributes?
$LOGGED_UTILITY_STREAM


Primer_NTFS_7
Which NTFS attribute that is composed of the file security and access control properties?
$SECURITY_DESCRIPTOR


Primer_NTFS_8
In NTFS, what is the type id, in hex, of the attribute that actually stores a NTFS files contents?
0x80


Primer_NTFS_9

In NTFS what is the maximum number of bytes a MFT entry (containing the entirety of a file) can contain to be considered "Resident Data"?

1024

Primer_NTFS_10


NTFS permissions can be a assigned to a filesystem object in two ways. Which way is intentionally assigned on the file or folder?

Explicit



Primer_NTFS_11
NTFS permissions can be a assigned to a filesystem object in two ways. Which way is the results of an object being assigned permissions as the result of being the child of another object?

Inherited



Primer_NTFS_12

Which NTFS file level permission is missing from the following list? Write, Read & Execute, Modify, Full Control


Read




Primer_NTFS_13
Which NTFS folder level permission is missing from the following list?: Read, Write, Read & Execute, Modify, Full control

List Folder Contents






Primer_NTFS_14


Which NTFS file level permission permits changing the contents of a file, deleting the file but does not allow the ability to change the permissions on the file?


Modify




Primer_NTFS_15
Which NTFS folder level permission allows changing permissions?

Full Control



Primer_NTFS_16
Which NTFS attribute stores the file times of an object?

$STANDARD_INFORMATION



Primer_NTFS_17
What CLI command will only show the letters of attached drives? **Hint command is 3 words

fsutil fsinfo drives




Windows_File_System_Basics_1
Every file on a Windows system has attributes. What does the d attribute mean?
directory



Windows_File_System_Basics_2
Every file on a Windows system has attributes. What does the h attribute mean?
hidden


Windows_File_System_Basics_3
What PowerShell command will list all files in the current directory, regardless of their attributes?

Get-ChildItem -Force




Windows_File_System_Basics_4

What PowerShell command will give you the sha512 hash of a file?

Flag format: command -argument

Get-FileHash -Algorithm SHA512


Windows_File_System_Basics_5

What PowerShell command will list permissions of a file?

Get-Acl



Windows_File_System_Basics_6

What Windows file maps hostnames to IP addresses?
C:\Windows\System32\drivers\etc\hosts




Windows_File_System_Basics_7
Which group has ReadandExecute (RX) permissions to the file listed in the previous challenge, File_System_Basics_6?

(Get-Acl -Path C:\Windows\System32\drivers\etc\hosts).Access

BUILTIN\Users



Windows_File_System_Basics_8
Find the last five characters of the MD5 hash of the hosts file.

Get-FileHash C:\Windows\System32\drivers\etc\hosts -Algorithm MD5

7566D






Windows_File_System_Basics_9

Examine the readme file somewhere in the CTF user’s home directory.

Reminder: All challenges are done on the file-server.


 Get-ChildItem -Path C:\Users\CTF -Include readme -File -recurse


conent of readmile file is 123456 in favorites directory.




Windows_File_System_Basics_10

There is a hidden directory in the CTF user's home directory. The directory contains a file. Read the file.
Get-ChildItem -Path C:\Users\CTF -Force -Directory -Attributes Hidden (finds secret sauce directory cd into and get content on the file)


ketchup




Windows_File_System_Basics_11

Find a file in a directory on the desktop with spaces in it. FLAG is the contents of the file

HINT: If you like to type the full names and paths of files, you better look for a shortcut.





Windows_File_System_Basics_11



Find a file in a directory on the desktop with spaces in it. FLAG is the contents of the file

HINT: If you like to type the full names and paths of files, you better look for a shortcut.


go to C:\Users\CTF\Desktop\z
do an LS
Then Get-content on the file:

987654321



Windows_File_System_Basics_12

Find the Alternate Data Stream in the CTF user's home, and read it.


go to C:\Users\CTF\Documents
Get-Content .\nothing_here -stream hidden


P455W0RD



Windows_File_System_Basics_13
"Fortune cookies" have been left around the system so that you won't find the hidden password...


Get-ChildItem -Path C:\  -File -recurse -ErrorAction SilentlyContinue   
cd  C:\Windows\PLA\not_anihc

Get-Item '.\The Fortune Cookie' -Stream *
C:\Windows\PLA\not_anihc\The Fortune Cookie:none
Get-Content 'C:\Windows\PLA\not_anihc\The Fortune Cookie:none' -stream *
fortune_cookie


Windows_File_System_Basics_14
There are plenty of phish in the C:\Users\CTF, but sometimes they're hidden in plain site.

Find the phish.

---------------------------------------------------------------------------------------------------------- Day 3-----------------------------------
Linux Basics 1

What command lists the contents of directories in Linux/Unix systems?

ls






Linux Basics 2

For the ls command, what arguments, or switch options, will allow you to print human-readable file sizes in a long-list format?

The flag is entire command, including arguments

ls -lh






Linux Basics 3

What character will pipe the standard output from

echo "I’m a plumber"

to another command, as standard input?


|
Linux Basics 4

What argument/switch option, when used with man, will search the short descriptions and man-page-names for a keyword that you provide?

The flag is the complete command, with argument/switch.


man -k <keyword>




Linux Basics LFS Hierarchy


What is the absolute path to the root directory?


/





Linux Basics LFS Hierarchy2

What is the absolute path to the default location for configuration files?



/etc


Linux Basics LFS Hierarchy3

What is the directory that contains executable programs (binaries) which are needed in single user mode, to bring the system up or to repair it?

/bin



Linux Basics LFS Hierarchy4
What is the absolute path to the directory which contains non-essential binaries that are accessible by standard users as well as root?


/usr/bin



Linux Basics LFS Hierarchy5

An absolute path to a directory which contains binaries only accessible by the root user, or users in the root group.

/sbin

Linux Basics LFS Hierarchy6
What is the absolute path for the binary cat man-page?

whereis cat

/usr/share/man/man1/cat.1.gz



Linux Basics 5

Search the man pages for the keyword digest. Then, use one of the binaries listed to hash the string OneWayBestWay using the largest sha hash available.

The resulting hash is the flag.


echo "OneWayBestWay' | sha512sum
a81bc463469ee1717fc9e388e3799c653f63a3de5e9496b5707b56488b046cbf75665235d316c5c0053a597dc7d40c917a2d9006fe35e9cb47766c05ac71989b



Linux Basics 6


Use File: /home/garviel/Encrypted

This file contains encrypted contents. Identify its file type, then decode its contents.

Hint: Use OpenSSL
Research: https://www.openssl.org/docs/man1.1.1/man1/enc.html

Reminder: All challenges are done using the Terra box.


openssl enc -d -aes-128-cbc -salt -in Encrypted -out decrypted -k AES128Key
unzip -n Encrypted
DeCrypt


Linux Basics LFS Hierarchy7

Search the user home directories to find the file with the second-most lines in it. The flag is the number of lines in the file.

Hint: Exclude the VDI file!


wc -l every file
20000






Linux Basics Users and Groups1

Read the file that contains the user database for the machine. Identify a strange comment.


cat /etc/passwd | cut -d: -f 5

Traitor








Linux Basics Users and Groups2

Identify all members of the lodge group. List their names in alphabetical order with a comma in between each name.

Flag Format: name,name,name



getent group lodge | awk -F':' '{print $4}' | tr ',' '\n' | sort | tr '\n' ','


aximand,erebus,ezekyle,garviel,sejanus,tarik






Linux Basics Users and Groups3
Find the user with a unique login shell.


cut -d ':' -f7 /etc/passwd | sort | uniq -u | while read -r shell; do grep ":$shell$" /etc/passwd | cut -d ':' -f1; done



nobody




Linux Basics Users and Groups4


Identify the algorithm, the amount of salted characters added, and the length of the hashed password in the file that stores passwords.

Hint: Research 'padding'...

Flag format: algorithm,#characters,#length



sudo cat /etc/shadow
sha512,8,86
look at root line to get this information




Linux Basics Permissions1
Find the directory named Bibliotheca. Enter the absolute path to the directory.

find / -type d -name "Bibliotheca" 2>/dev/null


/media/Bibliotheca


Linux Basics Permissions2
Identify the number of users with valid login shells, who can list the contents of the Bibliotheca directory.

cat /etc/group | grep chapter

7


Linux Basics Permissions3

The permissions that user sejanus has on /media/Bibliotheca, in octal format.

Flag format: #

HINT: Think about groups...

ls -lisa /media/
5 because he has r and x persmissions 





Linux Basics Permissions 4
Locate the file within /media/Bibliotheca that is modifiable by the only user that is part of the chapter group, but not part of the lodge group.

Hint: Not the hidden file...

cd Bibliotheca_unus
ls -lisa
Codex_Astartes





Linux Basics Permissions 5
Identify the file within /media/Bibliotheca where the owning group has more rights than the owning user.


cd Bibliotheca_quattuor/
ls -lisa
Codex_Hereticus






Linux Basics Permissions 6






Execute the file owned by the guardsmen group in /media/Bibliotheca, as the owning user.

The flag is the code name provided after a successful access attempt.

Hint: Remember your sudo options.


cd Bibliotheca_quattuor

sudo cat Tactica_Imperium

GHOSTS


Linux Basics Permissions 7




The user tyborc is unable to access the directory:

/media/Bibliotheca/Bibliotheca_unus

Why? Identify the permission missing in standard verb form.


I guesssed execute
execute

Linux Basics Permissions 8



You only have a single submission attempt for this challenge.

Locate the file in /media/Bibliotheca that Quixos has sole modification rights on.

The flag is the absolute path for the file, include the file name.


/media/Bibliotheca/Bibliotheca_duo/Codex_Hereticus







Linux Basics Permissions9


Read a concealed file within /media/Bibliotheca

cat .Secrets_of_the_Immaterium
Expand your mind


Linux Basics Permissions10
Find the warp and read its secrets for the flag.







Linux Basics Regular Expressions1
Using the commands ls and grep, identify the number of directories in /etc/ that end in .d

ls -l /etc/ | grep '^d.*\.d$' | wc -l

28





Linux Basics Regular Expressions2


File: home/garviel/numbers

Use regular expressions to match patterns similar to valid and invalid IP addresses.

The answer is the count/number of lines that match in the file.




Linux Basics Regular Expressions3


File: home/garviel/numbers

Use regular expressions to match valid IP addresses. The flag is the number of addresses.

HINT: What are the valid numerical values of each octet in an IP address?

grep -P '\b(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\b' /home/garviel/numbers | wc -l




18


Linux Basics Regular Expressions4


File: home/garviel/numbers

Use regular expressions to match patterns that look similar to a MAC Address. Flag is a count of the number of matches.

HINT: This is a loose match! Some of these results won't be true MAC addresses.

Flag format: ####



Linux Basics Reformat1


File: home/garviel/numbers

Use awk to print lines:

>= 420 AND <=1337

The flag is a SHA512 hash of the output.



awk 'NR >= 420 && NR <= 1337' /home/garviel/numbers | sha512sum

e62ff70d772ef0977f4f8fe1751fda5689ce1daf1fabc6d0cc49da234d02719986c0acb97f582166170a5a1f418e854602a5eb98c773655906a3f85440c37d39







Linux Basics Regular Expressions5


File: home/garviel/numbers

Use regular expressions to find valid Locally Administered or Universally Administered Unicast MAC addresses.

Give the count of Locally and Universally Administered MAC addresses as the answer.

HINT: What characters specifically define a Locally or Universally Administered Unicast MAC Address?



------------------------------------------------------------------------------------------------------------Day 4-----------------------------------------
Primer_Boot_Process_1

What is the smallest addressable unit on a hard disk?

Research: https://learn.microsoft.com/en-us/windows/win32/fileio/disk-devices-and-partitions

Sector





Primer_Boot_Process_2





What term describes a logical division of a single storage device?

Research: https://learn.microsoft.com/en-us/windows/win32/fileio/disk-devices-and-partitions


Partition





Primer_Boot_Process_3


What term describes a formatted storage device that can span 1 or more partitions, has a single file system and is assigned a drive letter?

Research: https://learn.microsoft.com/en-us/windows-hardware/drivers/ifs/storage-device-stacks--storage-volumes--and-file-system-stacks

Volume



Primer_Boot_Process_4

What CLI disk partitioning tool is available in Windows to view and manipulate both partitions and volumes?

Research: https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/diskpart

Diskpart


Primer_Boot_Process_5

Windows includes 4 critical Kernel-mode components. Which component is a matched pair with the kernel and obfuscates the hardware dependencies from the kernel?
Kernel
Executive
HAL
Device 

Answer: HAL


Primer_Boot_Process_6



Windows includes 4 critical Kernel-mode components. Which component directs calls from a user-mode process to the kernel services?
Kernel
Executive
HAL
Device

Research: https://en.wikipedia.org/wiki/Architecture_of_Windows_NT#Executive

Answer: Executive


Primer_Boot_Process_7



This provides an operating system with a software interface to a hardware device

Research: https://learn.microsoft.com/en-us/windows-hardware/drivers/gettingstarted/what-is-a-driver-


Driver



Primer_Boot_Process_8



What are the two firmware interfaces supported by modern computers and read in the Pre-boot phase of the Windows boot process?

**Hint, answer format = _______ and _______

Research: https://learn.microsoft.com/en-us/windows-hardware/manufacture/desktop/boot-to-uefi-mode-or-legacy-bios-mode?view=windows-11






