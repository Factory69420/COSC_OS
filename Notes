
----------------------------------------------------------------------------------------DAY 1-----------------------------------------------------------------------------------------------------------

COSC NOTES 
I am Stack #9
Stack#9 IP:
10.50.27.51

US ARMY CYBER SCHOOL:
http://10.50.22.197:8000

Username: KAEL-M-24-503
Password: Carmel123!

Class name: M24503
Password: password






xfreerdp /u:student /v:10.50.27.51 /dynamic-resolution +glyph-cache +clipboard

ssh student@10.50.27.51


Windows_PowerShell_Regex_5
Count the number of words in words.txt that meet the following criteria:

    a appears at least twice consecutively
    and is followed immediately by any of the letters a through g
    Note: File Location - C:\Users\CTF\Desktop\CTF
    Example: aac...aaa...


Get-Content C:\Users\CTF\Desktop\words.txt | Where-Object {$_ -Match 'aa[a-g]'} | Measure-Object




Windows_PowerShell_Profiles6


What command would you run to view the help for PowerShell Profiles?


Get-Help about_Profiles






Windows_PowerShell_Profiles7

What command would tell you if there was a profile loaded for All Users All Hosts?

Flag is the full command syntax


Test-Path $PROFILE.AllUsersAllHosts





Windows_PowerShell_Profiles8

Challenge only allows ONE attempt

Malware is running on the primary PowerShell profile on the File-Server. Based on PowerShell profile order of precedence (what is read first), find the correct flag.

The flag is the string after the #, without the preceding space.




$Profile | Get-Member -MemberType NoteProperty

Get-Content $Profile.AllUsersAllHosts



Use a PowerShell loop to unzip the Omega file 1,000 times and read what is inside.

Note: Make sure you back up the .zip file to a different directory before attempting this challenge.

$counter = 1000
do{$file = 'omega' + $counter + ".zip"; expand-archive $file -DestinationPath <filepath>; $counter -- }until($counter -eq 0)

do{$file = 'omega' + $counter + ".zip"; expand-archive $file -DestinationPath C:\Use
rs\CTF\Documents\; $counter -- }until($counter -eq 0)

------------------------------------------------------------------------------------------DAY 2------------------------------------------------------------------------------------------------------------------
Get-WmiObject win32_useraccount | fl -Property name, sid

Primer_Registry_1
What Windows registry path is the Volatile Hive?
HKLM\HARDWARE




Primer_Registry_2
What registry key creates the Wow6432Node to represent 32-bit applications that run on a 64-bit version of Windows?

HKEY_LOCAL_MACHINE\SOFTWARE



Primer_Registry_3
In what registry path are the BOOT_START drivers located?
HKLM\SYSTEM\CurrentControlSet\Services


Primer_Registry_4
What start value do BOOT_START drivers have in the registry?
0x0



Primer_Registry_5
During kernel initialization, what registry location is read containing all SYSTEM_START drivers?
HKLM\SYSTEM\CurrentControlSet\Services


Primer_Registry_6
SERVICE_AUTO_START drivers and services are loaded after kernel initialization. What start value do they have in the registry?
0x2


Primer_Registry_7
What start value do SERVICE_DEMAND_START drivers and services have in the registry?
0x3


Primer_Registry_8
When accessing a remote registry which are the only 2 accessible HKEYs?

SYNTAX Hive, Hive
HKLM, HKU



Primer_Registry_9
What PowerShell cmdlet will list currently mapped drives?
Get-PSDrive



Primer_Registry_10
What is the native Windows GUI tool for managing the registry?
regedit


Windows_Registry_Basics_1
What registry hive contains all machine settings?
HKLM



Windows_Registry_Basics_2
What registry hive contains all user settings?
HKU

Windows_Registry_Basics_3
What registry hive contains only the currently logged-in user's settings?
HKCU


Windows_Registry_Basics_4
The HKEY_CURRENT_USER registry hive is a symbolic link to another registry subkey. What is the subkey that it is linked to?

Flag format: HIVE\SID.........................

Reminder: All challenges are done using Workstation2.
LOOK AT MAP FOR REMINDER WHO TO SSH IN AS. IN THIS CASE IT WANTS andy.dwyer
 
HKU\S-1-5-21-2881336348-3190591231-4063445930-1004


Windows_Registry_Basics_5
What PowerShell command will list all the subkeys and contents in the current directory and/or will list all the subkeys and the contents of a directory you specify?

Get-ChildItem





Windows_Registry_Basics_6
What PowerShell command will list only the contents of a registry key or subkey?
Get-Item


Windows_Registry_Basics_7
What registry subkey runs every time the machine reboots? The flag is the full path, using PowerShell.
HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUN



Windows_Registry_Basics_8
What registry subkey runs every time a user logs on? The flag is the full path, using PowerShell.

Flag format: FULL\PATH\ALL\CAPS


HKEY_CURRENT_USER\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUN





Windows_Registry_Basics_9
What registry subkey runs a single time, then deletes its value once the machine reboots? The flag is the full path, using PowerShell.

Flag format: FULL\PATH\ALL\CAPS




HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUNONCE



Windows_Registry_Basics_10

What registry subkey runs a single time, then deletes its value when a user logs on? The flag is the full path, using PowerShell.

Flag format: FULL\PATH\ALL\CAPS

HKEY_CURRENT_USER\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUNONCE




Windows_Registry_Basics_11

What is the suspicious value inside of the registry subkey from your previous challenge named registry_basics_7?

reg query HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUN

C:\malware.exe








Windows_Registry_Basics_12

What is the suspicious value inside of the registry subkey that loads every time the "Student" user logs on?

HKEY_CURRENT_USER\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUN
C:\botnet.exe







Windows_Registry_Basics_13

What is the value inside of the registry subkey from registry_basics_9?

reg query HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUNONCE
C:\virus.exe






Windows_Registry_Basics_14

What is the value inside of the registry subkey that loads a single time when the "student" user logs on?

reg query HKEY_CURRENT_USER\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUNONCE
C:\worm.exe


Windows_Registry_Basics_15

Figure out the manufacturer's name of the only USB drive that was plugged into this machine.
reg query HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Enum\USBSTOR

SanDisk9834





Windows_Registry_Basics_16

What suspicious user profile, found in the registry, has connected to this machine?



Windows_Registry_Basics_17

What suspicious wireless network, found in the registry, has this system connected to?





Primer_NTFS_1

The ____ determines how the data is stored on disk.

(Fill in the blank)
File System






Primer_NTFS_2
What are NTFS partition sectors grouped into?
Clusters



Primer_NTFS_3
What contains the metadata about all of the files and directories on a NTFS partition?
Master File Table



Primer_NTFS_4
NTFS files are collections of what?
attributes




Primer_NTFS_5
Which NTFS attribute would store an alternate data stream?
$DATA




Primer_NTFS_6
Which NTFS attribute holds information about a file's encrypted attributes?
$LOGGED_UTILITY_STREAM


Primer_NTFS_7
Which NTFS attribute that is composed of the file security and access control properties?
$SECURITY_DESCRIPTOR


Primer_NTFS_8
In NTFS, what is the type id, in hex, of the attribute that actually stores a NTFS files contents?
0x80


Primer_NTFS_9

In NTFS what is the maximum number of bytes a MFT entry (containing the entirety of a file) can contain to be considered "Resident Data"?

1024

Primer_NTFS_10


NTFS permissions can be a assigned to a filesystem object in two ways. Which way is intentionally assigned on the file or folder?

Explicit



Primer_NTFS_11
NTFS permissions can be a assigned to a filesystem object in two ways. Which way is the results of an object being assigned permissions as the result of being the child of another object?

Inherited



Primer_NTFS_12

Which NTFS file level permission is missing from the following list? Write, Read & Execute, Modify, Full Control


Read




Primer_NTFS_13
Which NTFS folder level permission is missing from the following list?: Read, Write, Read & Execute, Modify, Full control

List Folder Contents






Primer_NTFS_14


Which NTFS file level permission permits changing the contents of a file, deleting the file but does not allow the ability to change the permissions on the file?


Modify




Primer_NTFS_15
Which NTFS folder level permission allows changing permissions?

Full Control



Primer_NTFS_16
Which NTFS attribute stores the file times of an object?

$STANDARD_INFORMATION



Primer_NTFS_17
What CLI command will only show the letters of attached drives? **Hint command is 3 words

fsutil fsinfo drives




Windows_File_System_Basics_1
Every file on a Windows system has attributes. What does the d attribute mean?
directory



Windows_File_System_Basics_2
Every file on a Windows system has attributes. What does the h attribute mean?
hidden


Windows_File_System_Basics_3
What PowerShell command will list all files in the current directory, regardless of their attributes?

Get-ChildItem -Force




Windows_File_System_Basics_4

What PowerShell command will give you the sha512 hash of a file?

Flag format: command -argument

Get-FileHash -Algorithm SHA512


Windows_File_System_Basics_5

What PowerShell command will list permissions of a file?

Get-Acl



Windows_File_System_Basics_6

What Windows file maps hostnames to IP addresses?
C:\Windows\System32\drivers\etc\hosts




Windows_File_System_Basics_7
Which group has ReadandExecute (RX) permissions to the file listed in the previous challenge, File_System_Basics_6?

(Get-Acl -Path C:\Windows\System32\drivers\etc\hosts).Access

BUILTIN\Users



Windows_File_System_Basics_8
Find the last five characters of the MD5 hash of the hosts file.

Get-FileHash C:\Windows\System32\drivers\etc\hosts -Algorithm MD5

7566D






Windows_File_System_Basics_9

Examine the readme file somewhere in the CTF user’s home directory.

Reminder: All challenges are done on the file-server.


 Get-ChildItem -Path C:\Users\CTF -Include readme -File -recurse


conent of readmile file is 123456 in favorites directory.




Windows_File_System_Basics_10

There is a hidden directory in the CTF user's home directory. The directory contains a file. Read the file.
Get-ChildItem -Path C:\Users\CTF -Force -Directory -Attributes Hidden (finds secret sauce directory cd into and get content on the file)


ketchup




Windows_File_System_Basics_11

Find a file in a directory on the desktop with spaces in it. FLAG is the contents of the file

HINT: If you like to type the full names and paths of files, you better look for a shortcut.





Windows_File_System_Basics_11



Find a file in a directory on the desktop with spaces in it. FLAG is the contents of the file

HINT: If you like to type the full names and paths of files, you better look for a shortcut.


go to C:\Users\CTF\Desktop\z
do an LS
Then Get-content on the file:

987654321



Windows_File_System_Basics_12

Find the Alternate Data Stream in the CTF user's home, and read it.

