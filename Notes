
----------------------------------------------------------------------------------------DAY 1-----------------------------------------------------------------------------------------------------------

COSC NOTES 
I am Stack #9
Stack#9 IP:
10.50.27.51

US ARMY CYBER SCHOOL:
http://10.50.22.197:8000

Username: KAEL-M-24-503
Password: Carmel123!

Class name: M24503
Password: password
Test is June 14th on Friday

./strings *.exe -accepteula



xfreerdp /u:student /v:10.50.27.51 /dynamic-resolution +glyph-cache +clipboard

ssh student@10.50.27.51


Windows_PowerShell_Regex_5
Count the number of words in words.txt that meet the following criteria:

    a appears at least twice consecutively
    and is followed immediately by any of the letters a through g
    Note: File Location - C:\Users\CTF\Desktop\CTF
    Example: aac...aaa...


Get-Content C:\Users\CTF\Desktop\words.txt | Where-Object {$_ -Match 'aa[a-g]'} | Measure-Object




Windows_PowerShell_Profiles6


What command would you run to view the help for PowerShell Profiles?


Get-Help about_Profiles






Windows_PowerShell_Profiles7

What command would tell you if there was a profile loaded for All Users All Hosts?

Flag is the full command syntax


Test-Path $PROFILE.AllUsersAllHosts





Windows_PowerShell_Profiles8

Challenge only allows ONE attempt

Malware is running on the primary PowerShell profile on the File-Server. Based on PowerShell profile order of precedence (what is read first), find the correct flag.

The flag is the string after the #, without the preceding space.




$Profile | Get-Member -MemberType NoteProperty

Get-Content $Profile.AllUsersAllHosts



Use a PowerShell loop to unzip the Omega file 1,000 times and read what is inside.

Note: Make sure you back up the .zip file to a different directory before attempting this challenge.

$counter = 1000
do{$file = 'omega' + $counter + ".zip"; expand-archive $file -DestinationPath <filepath>; $counter -- }until($counter -eq 0)

do{$file = 'omega' + $counter + ".zip"; expand-archive $file -DestinationPath C:\Use
rs\CTF\Documents\; $counter -- }until($counter -eq 0)

------------------------------------------------------------------------------------------DAY 2------------------------------------------------------------------------------------------------------------------
Get-WmiObject win32_useraccount | fl -Property name, sid

Primer_Registry_1
What Windows registry path is the Volatile Hive?
HKLM\HARDWARE




Primer_Registry_2
What registry key creates the Wow6432Node to represent 32-bit applications that run on a 64-bit version of Windows?

HKEY_LOCAL_MACHINE\SOFTWARE



Primer_Registry_3
In what registry path are the BOOT_START drivers located?
HKLM\SYSTEM\CurrentControlSet\Services


Primer_Registry_4
What start value do BOOT_START drivers have in the registry?
0x0



Primer_Registry_5
During kernel initialization, what registry location is read containing all SYSTEM_START drivers?
HKLM\SYSTEM\CurrentControlSet\Services


Primer_Registry_6
SERVICE_AUTO_START drivers and services are loaded after kernel initialization. What start value do they have in the registry?
0x2


Primer_Registry_7
What start value do SERVICE_DEMAND_START drivers and services have in the registry?
0x3


Primer_Registry_8
When accessing a remote registry which are the only 2 accessible HKEYs?

SYNTAX Hive, Hive
HKLM, HKU



Primer_Registry_9
What PowerShell cmdlet will list currently mapped drives?
Get-PSDrive



Primer_Registry_10
What is the native Windows GUI tool for managing the registry?
regedit


Windows_Registry_Basics_1
What registry hive contains all machine settings?
HKLM



Windows_Registry_Basics_2
What registry hive contains all user settings?
HKU

Windows_Registry_Basics_3
What registry hive contains only the currently logged-in user's settings?
HKCU


Windows_Registry_Basics_4
The HKEY_CURRENT_USER registry hive is a symbolic link to another registry subkey. What is the subkey that it is linked to?

Flag format: HIVE\SID.........................

Reminder: All challenges are done using Workstation2.
LOOK AT MAP FOR REMINDER WHO TO SSH IN AS. IN THIS CASE IT WANTS andy.dwyer
 
HKU\S-1-5-21-2881336348-3190591231-4063445930-1004


Windows_Registry_Basics_5
What PowerShell command will list all the subkeys and contents in the current directory and/or will list all the subkeys and the contents of a directory you specify?

Get-ChildItem





Windows_Registry_Basics_6
What PowerShell command will list only the contents of a registry key or subkey?
Get-Item


Windows_Registry_Basics_7
What registry subkey runs every time the machine reboots? The flag is the full path, using PowerShell.
HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUN



Windows_Registry_Basics_8
What registry subkey runs every time a user logs on? The flag is the full path, using PowerShell.

Flag format: FULL\PATH\ALL\CAPS


HKEY_CURRENT_USER\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUN





Windows_Registry_Basics_9
What registry subkey runs a single time, then deletes its value once the machine reboots? The flag is the full path, using PowerShell.

Flag format: FULL\PATH\ALL\CAPS




HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUNONCE



Windows_Registry_Basics_10

What registry subkey runs a single time, then deletes its value when a user logs on? The flag is the full path, using PowerShell.

Flag format: FULL\PATH\ALL\CAPS

HKEY_CURRENT_USER\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUNONCE




Windows_Registry_Basics_11

What is the suspicious value inside of the registry subkey from your previous challenge named registry_basics_7?

reg query HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUN

C:\malware.exe








Windows_Registry_Basics_12

What is the suspicious value inside of the registry subkey that loads every time the "Student" user logs on?

HKEY_CURRENT_USER\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUN
C:\botnet.exe







Windows_Registry_Basics_13

What is the value inside of the registry subkey from registry_basics_9?

reg query HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUNONCE
C:\virus.exe






Windows_Registry_Basics_14

What is the value inside of the registry subkey that loads a single time when the "student" user logs on?

reg query HKEY_CURRENT_USER\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUNONCE
C:\worm.exe


Windows_Registry_Basics_15

Figure out the manufacturer's name of the only USB drive that was plugged into this machine.
reg query HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Enum\USBSTOR

SanDisk9834





Windows_Registry_Basics_16

What suspicious user profile, found in the registry, has connected to this machine?



Windows_Registry_Basics_17

What suspicious wireless network, found in the registry, has this system connected to?





Primer_NTFS_1

The ____ determines how the data is stored on disk.

(Fill in the blank)
File System






Primer_NTFS_2
What are NTFS partition sectors grouped into?
Clusters



Primer_NTFS_3
What contains the metadata about all of the files and directories on a NTFS partition?
Master File Table



Primer_NTFS_4
NTFS files are collections of what?
attributes




Primer_NTFS_5
Which NTFS attribute would store an alternate data stream?
$DATA




Primer_NTFS_6
Which NTFS attribute holds information about a file's encrypted attributes?
$LOGGED_UTILITY_STREAM


Primer_NTFS_7
Which NTFS attribute that is composed of the file security and access control properties?
$SECURITY_DESCRIPTOR


Primer_NTFS_8
In NTFS, what is the type id, in hex, of the attribute that actually stores a NTFS files contents?
0x80


Primer_NTFS_9

In NTFS what is the maximum number of bytes a MFT entry (containing the entirety of a file) can contain to be considered "Resident Data"?

1024

Primer_NTFS_10


NTFS permissions can be a assigned to a filesystem object in two ways. Which way is intentionally assigned on the file or folder?

Explicit



Primer_NTFS_11
NTFS permissions can be a assigned to a filesystem object in two ways. Which way is the results of an object being assigned permissions as the result of being the child of another object?

Inherited



Primer_NTFS_12

Which NTFS file level permission is missing from the following list? Write, Read & Execute, Modify, Full Control


Read




Primer_NTFS_13
Which NTFS folder level permission is missing from the following list?: Read, Write, Read & Execute, Modify, Full control

List Folder Contents






Primer_NTFS_14


Which NTFS file level permission permits changing the contents of a file, deleting the file but does not allow the ability to change the permissions on the file?


Modify




Primer_NTFS_15
Which NTFS folder level permission allows changing permissions?

Full Control



Primer_NTFS_16
Which NTFS attribute stores the file times of an object?

$STANDARD_INFORMATION



Primer_NTFS_17
What CLI command will only show the letters of attached drives? **Hint command is 3 words

fsutil fsinfo drives




Windows_File_System_Basics_1
Every file on a Windows system has attributes. What does the d attribute mean?
directory



Windows_File_System_Basics_2
Every file on a Windows system has attributes. What does the h attribute mean?
hidden


Windows_File_System_Basics_3
What PowerShell command will list all files in the current directory, regardless of their attributes?

Get-ChildItem -Force




Windows_File_System_Basics_4

What PowerShell command will give you the sha512 hash of a file?

Flag format: command -argument

Get-FileHash -Algorithm SHA512


Windows_File_System_Basics_5

What PowerShell command will list permissions of a file?

Get-Acl



Windows_File_System_Basics_6

What Windows file maps hostnames to IP addresses?
C:\Windows\System32\drivers\etc\hosts




Windows_File_System_Basics_7
Which group has ReadandExecute (RX) permissions to the file listed in the previous challenge, File_System_Basics_6?

(Get-Acl -Path C:\Windows\System32\drivers\etc\hosts).Access

BUILTIN\Users



Windows_File_System_Basics_8
Find the last five characters of the MD5 hash of the hosts file.

Get-FileHash C:\Windows\System32\drivers\etc\hosts -Algorithm MD5

7566D






Windows_File_System_Basics_9

Examine the readme file somewhere in the CTF user’s home directory.

Reminder: All challenges are done on the file-server.


 Get-ChildItem -Path C:\Users\CTF -Include readme -File -recurse


conent of readmile file is 123456 in favorites directory.




Windows_File_System_Basics_10

There is a hidden directory in the CTF user's home directory. The directory contains a file. Read the file.
Get-ChildItem -Path C:\Users\CTF -Force -Directory -Attributes Hidden (finds secret sauce directory cd into and get content on the file)


ketchup




Windows_File_System_Basics_11

Find a file in a directory on the desktop with spaces in it. FLAG is the contents of the file

HINT: If you like to type the full names and paths of files, you better look for a shortcut.





Windows_File_System_Basics_11



Find a file in a directory on the desktop with spaces in it. FLAG is the contents of the file

HINT: If you like to type the full names and paths of files, you better look for a shortcut.


go to C:\Users\CTF\Desktop\z
do an LS
Then Get-content on the file:

987654321



Windows_File_System_Basics_12

Find the Alternate Data Stream in the CTF user's home, and read it.


go to C:\Users\CTF\Documents
Get-Content .\nothing_here -stream hidden


P455W0RD



Windows_File_System_Basics_13
"Fortune cookies" have been left around the system so that you won't find the hidden password...


Get-ChildItem -Path C:\  -File -recurse -ErrorAction SilentlyContinue   
cd  C:\Windows\PLA\not_anihc

Get-Item '.\The Fortune Cookie' -Stream *
C:\Windows\PLA\not_anihc\The Fortune Cookie:none
Get-Content 'C:\Windows\PLA\not_anihc\The Fortune Cookie:none' -stream *
fortune_cookie


Windows_File_System_Basics_14
There are plenty of phish in the C:\Users\CTF, but sometimes they're hidden in plain site.

Find the phish.

---------------------------------------------------------------------------------------------------------- Day 3-----------------------------------
Linux Basics 1

What command lists the contents of directories in Linux/Unix systems?

ls






Linux Basics 2

For the ls command, what arguments, or switch options, will allow you to print human-readable file sizes in a long-list format?

The flag is entire command, including arguments

ls -lh






Linux Basics 3

What character will pipe the standard output from

echo "I’m a plumber"

to another command, as standard input?


|
Linux Basics 4

What argument/switch option, when used with man, will search the short descriptions and man-page-names for a keyword that you provide?

The flag is the complete command, with argument/switch.


man -k <keyword>




Linux Basics LFS Hierarchy


What is the absolute path to the root directory?


/





Linux Basics LFS Hierarchy2

What is the absolute path to the default location for configuration files?



/etc


Linux Basics LFS Hierarchy3

What is the directory that contains executable programs (binaries) which are needed in single user mode, to bring the system up or to repair it?

/bin



Linux Basics LFS Hierarchy4
What is the absolute path to the directory which contains non-essential binaries that are accessible by standard users as well as root?


/usr/bin



Linux Basics LFS Hierarchy5

An absolute path to a directory which contains binaries only accessible by the root user, or users in the root group.

/sbin

Linux Basics LFS Hierarchy6
What is the absolute path for the binary cat man-page?

whereis cat

/usr/share/man/man1/cat.1.gz



Linux Basics 5

Search the man pages for the keyword digest. Then, use one of the binaries listed to hash the string OneWayBestWay using the largest sha hash available.

The resulting hash is the flag.


echo "OneWayBestWay' | sha512sum
a81bc463469ee1717fc9e388e3799c653f63a3de5e9496b5707b56488b046cbf75665235d316c5c0053a597dc7d40c917a2d9006fe35e9cb47766c05ac71989b



Linux Basics 6


Use File: /home/garviel/Encrypted

This file contains encrypted contents. Identify its file type, then decode its contents.

Hint: Use OpenSSL
Research: https://www.openssl.org/docs/man1.1.1/man1/enc.html

Reminder: All challenges are done using the Terra box.


openssl enc -d -aes-128-cbc -salt -in Encrypted -out decrypted -k AES128Key
unzip -n Encrypted
DeCrypt


Linux Basics LFS Hierarchy7

Search the user home directories to find the file with the second-most lines in it. The flag is the number of lines in the file.

Hint: Exclude the VDI file!


wc -l every file
20000






Linux Basics Users and Groups1

Read the file that contains the user database for the machine. Identify a strange comment.


cat /etc/passwd | cut -d: -f 5

Traitor








Linux Basics Users and Groups2

Identify all members of the lodge group. List their names in alphabetical order with a comma in between each name.

Flag Format: name,name,name



getent group lodge | awk -F':' '{print $4}' | tr ',' '\n' | sort | tr '\n' ','


aximand,erebus,ezekyle,garviel,sejanus,tarik






Linux Basics Users and Groups3
Find the user with a unique login shell.


cut -d ':' -f7 /etc/passwd | sort | uniq -u | while read -r shell; do grep ":$shell$" /etc/passwd | cut -d ':' -f1; done



nobody




Linux Basics Users and Groups4


Identify the algorithm, the amount of salted characters added, and the length of the hashed password in the file that stores passwords.

Hint: Research 'padding'...

Flag format: algorithm,#characters,#length



sudo cat /etc/shadow
sha512,8,86
look at root line to get this information




Linux Basics Permissions1
Find the directory named Bibliotheca. Enter the absolute path to the directory.

find / -type d -name "Bibliotheca" 2>/dev/null


/media/Bibliotheca


Linux Basics Permissions2
Identify the number of users with valid login shells, who can list the contents of the Bibliotheca directory.

cat /etc/group | grep chapter

7


Linux Basics Permissions3

The permissions that user sejanus has on /media/Bibliotheca, in octal format.

Flag format: #

HINT: Think about groups...

ls -lisa /media/
5 because he has r and x persmissions 





Linux Basics Permissions 4
Locate the file within /media/Bibliotheca that is modifiable by the only user that is part of the chapter group, but not part of the lodge group.

Hint: Not the hidden file...

cd Bibliotheca_unus
ls -lisa
Codex_Astartes





Linux Basics Permissions 5
Identify the file within /media/Bibliotheca where the owning group has more rights than the owning user.


cd Bibliotheca_quattuor/
ls -lisa
Codex_Hereticus






Linux Basics Permissions 6






Execute the file owned by the guardsmen group in /media/Bibliotheca, as the owning user.

The flag is the code name provided after a successful access attempt.

Hint: Remember your sudo options.


cd Bibliotheca_quattuor

sudo cat Tactica_Imperium

GHOSTS


Linux Basics Permissions 7




The user tyborc is unable to access the directory:

/media/Bibliotheca/Bibliotheca_unus

Why? Identify the permission missing in standard verb form.


I guesssed execute
execute

Linux Basics Permissions 8



You only have a single submission attempt for this challenge.

Locate the file in /media/Bibliotheca that Quixos has sole modification rights on.

The flag is the absolute path for the file, include the file name.


/media/Bibliotheca/Bibliotheca_duo/Codex_Hereticus







Linux Basics Permissions9


Read a concealed file within /media/Bibliotheca

cat .Secrets_of_the_Immaterium
Expand your mind


Linux Basics Permissions10
Find the warp and read its secrets for the flag.







Linux Basics Regular Expressions1
Using the commands ls and grep, identify the number of directories in /etc/ that end in .d

ls -l /etc/ | grep '^d.*\.d$' | wc -l

28





Linux Basics Regular Expressions2


File: home/garviel/numbers

Use regular expressions to match patterns similar to valid and invalid IP addresses.

The answer is the count/number of lines that match in the file.




Linux Basics Regular Expressions3


File: home/garviel/numbers

Use regular expressions to match valid IP addresses. The flag is the number of addresses.

HINT: What are the valid numerical values of each octet in an IP address?

grep -P '\b(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\b' /home/garviel/numbers | wc -l




18


Linux Basics Regular Expressions4


File: home/garviel/numbers

Use regular expressions to match patterns that look similar to a MAC Address. Flag is a count of the number of matches.

HINT: This is a loose match! Some of these results won't be true MAC addresses.

Flag format: ####



Linux Basics Reformat1


File: home/garviel/numbers

Use awk to print lines:

>= 420 AND <=1337

The flag is a SHA512 hash of the output.



awk 'NR >= 420 && NR <= 1337' /home/garviel/numbers | sha512sum

e62ff70d772ef0977f4f8fe1751fda5689ce1daf1fabc6d0cc49da234d02719986c0acb97f582166170a5a1f418e854602a5eb98c773655906a3f85440c37d39







Linux Basics Regular Expressions5


File: home/garviel/numbers

Use regular expressions to find valid Locally Administered or Universally Administered Unicast MAC addresses.

Give the count of Locally and Universally Administered MAC addresses as the answer.

HINT: What characters specifically define a Locally or Universally Administered Unicast MAC Address?



------------------------------------------------------------------------------------------------------------Day 4-----------------------------------------
Primer_Boot_Process_1

What is the smallest addressable unit on a hard disk?

Research: https://learn.microsoft.com/en-us/windows/win32/fileio/disk-devices-and-partitions

Sector





Primer_Boot_Process_2





What term describes a logical division of a single storage device?

Research: https://learn.microsoft.com/en-us/windows/win32/fileio/disk-devices-and-partitions


Partition





Primer_Boot_Process_3


What term describes a formatted storage device that can span 1 or more partitions, has a single file system and is assigned a drive letter?

Research: https://learn.microsoft.com/en-us/windows-hardware/drivers/ifs/storage-device-stacks--storage-volumes--and-file-system-stacks

Volume



Primer_Boot_Process_4

What CLI disk partitioning tool is available in Windows to view and manipulate both partitions and volumes?

Research: https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/diskpart

Diskpart


Primer_Boot_Process_5

Windows includes 4 critical Kernel-mode components. Which component is a matched pair with the kernel and obfuscates the hardware dependencies from the kernel?
Kernel
Executive
HAL
Device 

Answer: HAL


Primer_Boot_Process_6



Windows includes 4 critical Kernel-mode components. Which component directs calls from a user-mode process to the kernel services?
Kernel
Executive
HAL
Device

Research: https://en.wikipedia.org/wiki/Architecture_of_Windows_NT#Executive

Answer: Executive


Primer_Boot_Process_7



This provides an operating system with a software interface to a hardware device

Research: https://learn.microsoft.com/en-us/windows-hardware/drivers/gettingstarted/what-is-a-driver-


Driver



Primer_Boot_Process_8



What are the two firmware interfaces supported by modern computers and read in the Pre-boot phase of the Windows boot process?

**Hint, answer format = _______ and _______

Research: https://learn.microsoft.com/en-us/windows-hardware/manufacture/desktop/boot-to-uefi-mode-or-legacy-bios-mode?view=windows-11


UEFI and BIOS





Primer_Boot_Process_9


What is the name of the process that spawns SYSTEM?

Research: https://en.wikipedia.org/wiki/Windows_NT_booting_process (Hint: What really is SYSTEM?)


ntoskrnl.exe



Primer_Boot_Process_10



In Windows what does the boot sector code load into memory?

**Hint - Flag Format = ________ and ________

(Hint: What two things are between the MBR and the Kernel?) Research: https://learn.microsoft.com/en-us/troubleshoot/windows-client/performance/windows-boot-issues-troubleshooting



bootmgr and winload.exe



Primer_Boot_Process_11


In Windows 10 what is the name of the boot manager?

Research: https://learn.microsoft.com/en-us/troubleshoot/windows-client/performance/windows-boot-issues-troubleshooting


bootmgr



Primer_Boot_Process_12

In Microsoft Vista and later the boot.ini file was replaced by what?

Research: https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/boot-options-in-windows



BCD





Primer_Boot_Process_13

What is the tamper-resistant processor mounted on the motherboard used to improve the security of your PC. It's used by services like BitLocker drive encryption and Windows Hello to securely create and store cryptographic keys, and to confirm that the operating system and firmware on your device are what they're supposed to be, and haven't been tampered with.

Research: https://learn.microsoft.com/en-us/windows/security/information-protection/tpm/tpm-fundamentals



TPM



Primer_Boot_Process_14





During the Windows boot process, what starts BOOT_START device drivers and services with value of 0x0 in the registry key HKLM\SYSTEM\CurrentControlSet\Services?

Research: https://www.lifewire.com/what-is-winload-exe-2626051

Winload.exe





Primer_Boot_Process_15


During the Windows boot process, what starts SYSTEM_START device drivers and services with hex value of 0x1 in the registry key HKLM\SYSTEM\CurrentControlSet\Services?

Research: https://en.wikipedia.org/wiki/Ntoskrnl.exe

Ntoskrnl.exe


Primer_Boot_Process_16




During the Windows boot process, services.exe starts device drivers and services on demand with what hex value in the registry key HKLM\SYSTEM\CurrentControlSet\Services?

    hint syntax - #x#

Research: https://winreg-kb.readthedocs.io/en/latest/sources/system-keys/Services-and-drivers.html

0x2




Primer_Boot_Process_17

Starting in Windows Vista, what process spawns two additional instances (with identical names), used to initiate session 0 and session 1?

Research: https://www.ghacks.net/2007/12/27/csrssexe-smssexe-and-lsassexe/
https://techcommunity.microsoft.com/t5/ask-the-performance-team/sessions-desktops-and-windows-stations/ba-p/372473

smss.exe





Primer_Boot_Process_18



Which Windows Vista user session is non-interactive, contains system services and processes and is isolated from the GDI (Graphical Device Interface)

Research: https://techcommunity.microsoft.com/t5/ask-the-performance-team/sessions-desktops-and-windows-stations/ba-p/372473

0



Primer_Boot_Process_19


What is the boot process security feature available in UEFI systems, that only allows verified drivers to load?

Research: https://learn.microsoft.com/en-us/windows-hardware/design/device-experiences/oem-secure-boot


Secure boot


Primer_Boot_Process_20



To make booting faster, starting with Windows 8, the OS does a partial ________ of the kernel session at shutdown?

Research: https://learn.microsoft.com/en-us/windows/win32/power/system-power-states


hibernation


Primer_Boot_Process_21




What registry key is responsible for starting services on your machine during the boot process? Flag is the full registry path.

Research: https://www.picussecurity.com/resource/blog/picus-10-critical-mitre-attck-techniques-t1060-registry-run-keys-startup-folder






HKLM\Software\Microsoft\Windows\CurrentVersion\RunServices




Primer_Boot_Process_22


When a user logs on to a Windows host, authentication will either grant the user access to the local computer only (Local Logon) or the user will also be granted access to a Windows domain (Domain Logon). Which logon will the user be authenticated to via the Security Accounts Manager (SAM) database?

Research: https://learn.microsoft.com/en-us/windows-server/security/windows-authentication/windows-logon-scenarios


local logon



Primer_Boot_Process_23


What is the parent process of explorer.exe?

Research: https://en.wikipedia.org/wiki/Windows_NT_booting_process#Shell


userinit.exe




Primer_Boot_Process_24


What is responsible for handling Windows SAS (secure attention sequence), user profile loading, assignment of security to user shell, and Windows station and desktop protection?

Research: https://learn.microsoft.com/en-us/windows/win32/secauthn/winlogon


winlogon.exe





Primer_Boot_Process_25


What critical Windows process is initialized by wininit.exe, is responsible for creating the user's security access token and verifying user logon credentials?

Research: https://en.wikipedia.org/wiki/Local_Security_Authority_Subsystem_Service

lsass.exe


Primer_Boot_Process_26

What Microsoft recovery option overwrites the registry key HKLM\System\Select after every successful logon?

Research: https://learn.microsoft.com/en-us/troubleshoot/azure/virtual-machines/start-vm-last-known-good



Last Known Good Configuration 



Primer_Boot_Process_27


What authentication protocol is the default for logging onto an Active Directory domain and features SSO (Single-Sign On), mutual authentication and primarily uses symmetric cryptography?

Research: https://learn.microsoft.com/en-us/windows-server/security/kerberos/kerberos-authentication-overview


Kerberos




Primer_Boot_Process_28

In Kerberos the Active Directory controller serves as which major Kerberos component consisting of the Authentication Service (AS) and the Ticket Granting Service (TGS)

Research: https://learn.microsoft.com/en-us/windows/win32/secauthn/key-distribution-center



KDC





Primer_Boot_Process_29


When would the following Windows registry keys, actions occur? HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Userinit HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify

Research: https://www.picussecurity.com/resource/blog/picus-10-critical-mitre-attck-techniques-t1060-registry-run-keys-startup-folder



login


Primer_Kernel_1





The Windows NT Operating System attempts to combine features and benefits of microkernel and monolithic kernel architectures, making it which type of kernel architecture?

Research: https://www.educative.io/answers/what-is-windows-kernel


hybrid 



Primer_Kernel_2




The Linux kernel is an example of what type of kernel architecture?

Research: https://simple.wikipedia.org/wiki/Kernel_(computer_science)


monolithic




Primer_Kernel_3

Windows operating system name typically differs from its version number. Which Windows version includes Windows 7 and Windows Server 2008R2 and was the 1st version to ship with PowerShell?

**hint - only give the version number

Research: https://learn.microsoft.com/en-us/windows/win32/sysinfo/operating-system-version


6.1



Primer_Kernel_4

Which Windows version includes Windows Server 2016, 2019, 2022, Windows 10 & 11 and includes SMB 3.1.1 support?

Research: https://learn.microsoft.com/en-us/windows/win32/sysinfo/operating-system-version




10



Primer_Kernel_5




The CMD.EXE tool systeminfo included in Windows is very similar to msinfo32 and displays operating system configuration version information for a local or remote machine, including service pack levels.

Craft a systeminfo command that only returns the below info:
OS Version: "System OS and Build #"
BIOS Version: "Your BIOS Ver"

The Flag is the full command.

Research: https://ss64.com/nt/systeminfo.html 


systeminfo | findstr /C:"OS Version" /C:"BIOS Version"



Windows_Boot_Init_1

What is the first process to spawn on Windows systems after the kernel loads?




System

Windows_Boot_Init_2




What is the Process ID (PID) of the first Windows process?



4





Windows_Boot_Init_3

What is the second boot process to spawn, that then spawns csrss in both session 0 and session 1?



smss.exe


Windows_Boot_Init_4

What session ID do Windows services operate in?


0




Windows_Boot_Init_5


What process creates access tokens?

lsass.exe


Windows_Boot_Init_6
What is the parent process to all svchosts?



services.exe






Windows_Boot_Init_7



What process is waiting with high priority for the Secure Attention Sequence (SAS)?


winlogon.exe





Windows_Boot_Init_8


What user space process spawns explorer, then dies?



Windows_Boot_Init_9
What is the name of the bootloader, with extension, we are using on all of the Windows machines in this environment?

winload



Windows_Boot_Init_10

Challenge only allows ONE attempt

Based on the boot loader from Init_9, which firmware are we using (BIOS or UEFI) in our environment?







Windows_Boot_Init_11




What file saves the memory state to the hard drive when going into hibernation?


hiberfil.sys






Windows_Boot_Init_12

What bootloader is responsible for restoring the system to its original state after hibernation?


Winresume.exe






Windows_Boot_Remediate_1

The system is booting into safe mode. Identify the flag from the command-line output of the command used to diagnose boot issues.

Follow these instructions to boot the virtual image -- Click Here ---> Windows Bootkit Instructions

1RF5Zgf9P




Windows_Boot_Remediate_2



The system is booting into safe mode. Correct that, and reboot into the desktop. The flag is on the desktop.

Follow these Windows Bootkit Instructions to boot the virtual image


bcdedit /deletevalue {current} safeboot
76Drp6hB




---------------------------------------------------------------------------------------------------------Day 5------------------------------------------------------------------


Linux Boot Hex1


Solve the following equation:

0x31A - 0x21B

Enter the flag in Hexadecimal form.




0xFF







Linux Boot Bits and Bytes 1





How many bits are in a nibble, and a byte?

Flag format: #,#

4,8






Linux Boot Bits and Bytes 2

How many bits does a single Hexadecimal character represent?



4



Linux Boot Bits and Bytes 3



Each hex pair contains a value of 8 bits when used to represent memory. The range from 0x00000000 to 0x00000010 in hexadecimal represents addresses in memory or positions in data. This range includes the starting address (0x00000000) and ends at the address (0x00000010).

How many bytes could the range 0x00000000 - 0x00000010 contain?



17




Linux Boot MBR 1

How large is the Master Boot Record and what directory is it located in?

Flag format: #InBytes,fullpathdirectory


512,/dev










Linux Boot SysV 1




Identify which of your Linux machines is using SysV Initialization.




Minas_Tirith











Linux Boot Hex2


What are the maximum and minimum value a single Hexadecimal digit can contain?

Enter the values in Linux Hexadecimal Numerical Constant form.

Flag format: min-max

Research Hex to Decimal: https://www.aqua-calc.com/convert/number/hexadecimal-to-decimal


0x0-0xF




Linux Boot Hex3


What are the maximum and minimum values, in decimal notation, that a single Hexadecimal digit can represent?

Flag format: min-max



0-15



Linux Boot Hex4



Solve the following equation:

0x31A + 0x43

Enter the flag in Hexadecimal form.




0x35D




Linux Boot Bits and Bytes 4


Execute : sudo cat /dev/vda | xxd -l 32 -c 0x10 -g 1

What are the values contained in hex positions 0x00000001 through 0x00000008?

Flag format: Value,Value,Value,...

Machine: For this challenge: Minas_Tirith (ssh from Admin_Station)


 sudo cat /dev/vda | xxd -l 32 -c 0x10 -g 1
00000000: eb 63 90 8e d0 31 e4 8e d8 8e c0 be 00 7c bf 00  .c...1.......|..
00000010: 06 b9 00 01 f3 a5 be ee 07 b0 08 ea 20 06 00 00  ............ ...


Answer: 63, 90, 8e, d0, 31, e4, 8e, d8




Linux Boot MBR 2



Locate the master boot record for one of the Linux machines and read it with xxd

What programming language is the MBR written in?

HINT: Look at the first three bytes


assembly







    Challenge

Linux Boot MBR3

The file /home/bombadil/mbroken is a copy of an MBR from another machine.

Hash the first partition of the file using md5sum. The flag is the hash.



Linux Boot SysV 2
Identify the default run level on the SysV Init Linux machine.

Flag format: #


cat /etc/inittab | grep initdefault

2










Linux Boot SysV 3


What is the last script to run when the command init 6 is executed?

Flag format: /absolute/path

NOTE: “Use the Minas_Tirith machine for this question.”






/etc/init.d/reboot




Linux Boot SysV 4

What run levels start the daemon that allows remote connections over port 22?

Flag format: #,#,#,#

NOTE: Use the Minas_Tirith machine for this question.






2,3,4,5



Linux Boot Systemd 1




Identify the file that init is symbolically-linked to, on the SystemD init machine.

Flag format: /absolute/path

Reminder: Use your Terra machine for these SystemD challenges!








/lib/systemd/systemd



Linux Boot Systemd 2




What is the default target on the SystemD machine and where is it actually located?

Flag format: name.target,/absolute/path

NOTE: Use the SystemD Machine for this question.




graphical.target,/lib/systemd/system








Linux Boot Systemd 3



What unit does the graphical.target want to start, based solely on its configuration file?

HINT: Targets deal with which init system? Which machine should you be looking for this flag, on?

NOTE: Use the SystemD Machine for this question.







display-manager.service

















----------------------------------------------------------------------------------Day 6--------------------------------------------------------------------------

Primer_Processes1


What is the full path to folder used when Windows redirects 32 bit applications running on a 64bit system?

Research: https://learn.microsoft.com/en-us/windows/win32/winprog64/file-system-redirector




C:\Windows\SysWOW64






Primer_Processes2



What Windows System Service starts the kernel and user mode subsystems?

Research: https://en.wikipedia.org/wiki/Session_Manager_Subsystem



smss.exe




Primer_Processes3



What Windows system process:

    Runs in session 0
    is responsible for enforcing the security policy on the system
    Performs all logon functions
    Handles password changes
    Creates access tokens
    Writes to the Windows Security Log

Research: https://en.wikipedia.org/wiki/Local_Security_Authority_Subsystem_Service






LSASS





Primer_Processes4



Which is spoolsv.exe?
Server-mode service
User-mode service

Research: https://learn.microsoft.com/en-us/windows-hardware/drivers/print/introduction-to-spooler-components


Server-mode service






Primer_Processes5



Which service type is explorer.exe?
Server-mode service
User-mode service

Research: Link #1: https://learn.microsoft.com/en-us/windows-hardware/drivers/gettingstarted/user-mode-and-kernel-mode

Link #2: https://en.wikipedia.org/wiki/File_Explorer




User-mode service




Primer_Processes6




During a network survey you observed a host running inetinfo.exe service. What type of server might you have found?

Research: https://www.file.net/process/inetinfo.exe.html


web server




Primer_Processes7




During a reconnaissance mission you enumerated a host running the dns.exe service. Is this a user pc or a server?
user pc
server

Research: https://learn.microsoft.com/en-us/windows-server/networking/dns/dns-top


Server



Primer_Processes8


A host running firefox and office 365 is most likely what type of host? Server or Client

Research: https://learntomato.flashrouters.com/what-is-a-client-what-is-a-server-what-is-a-host/

Client



Primer_Processes9



How does a User-Mode Service request resources?

Research:

https://www.educative.io/answers/what-is-user-mode-vs-kernel-mode-in-an-operating-system




system calls


Primer_Processes10






Passively copying currently running processes for comparison later is known as?

Research: https://isc.sans.edu/diary/Baselining+Servers+to+Detect+Outliers/22940






Baselining



Primer_Processes11



What can execute any part of a processes code, to include parts already being executed?

Research: https://learn.microsoft.com/en-us/windows/win32/procthread/processes-and-threads


threads



Primer_Processes12



Windows has how many process priority levels?

Research: https://learn.microsoft.com/en-us/windows/win32/procthread/scheduling-priorities



32


Windows_Processes_Basics_1



What Sysinternals tool shows malware persistence locations in tabs within its GUI?

Research: https://learn.microsoft.com/en-us/sysinternals


Autoruns





Windows_Processes_Basics_2

What Sysinternals tool is used to investigate processes?


Process Explorer





Windows_Processes_Basics_3

What Sysinternals tool can be used to investigate network connection attempts?



TCPView



Windows_Processes_Basics_4


What Sysinternals tool can view permissions?


AccessChk



Windows_Processes_Basics_5

What Sysinternals tool allows us to view and modify handles?


Handle


Windows_Processes_Basics_6

What is the default Windows user directory for files downloaded from the internet? The flag is the folder name only.

Downloads

Windows_Processes_Basics_7

What is the default Windows download directory that everyone has access to? The flag is the absolute path to the directory

C:\Users\Public\Downloads

Windows_Processes_Basics_8

What Sysinternals tool shows service load order?

LoadOrder

Windows_Processes_Basics_9
What is the service name of Windows Defender Firewall?

MpsSvc

Windows_Processes_Basics_10

What SysInternals tool reports .dlls loaded into processes?

listdlls



Windows_Hidden_Processes_1




There is malware on the system that is named similarly to a legitimate Windows executable. There is a .dll in the folder that the malware runs from. The flag is the name of the .dll.

Reminder: All challenges are done using Workstation1.



libmingwex-0


(check startup it has similiar name to svchost process or whatever)




Windows_Hidden_Processes_2

You notice that there is an annoying pop up happening regularly. Investigate the process causing it. The flag is the name of the executable.


McAfeeFireTray.exe





Windows_Hidden_Processes_3



Determine what is sending out a SYN_SENT message. The flag is the name of the executable.

HINT: Use a Sysinternals tool.


(use TCPVIEW and filter for SYN_SENT)

McAfeeFireTray.exe



Windows_Hidden_Processes_4

Malware uses names of legit processes to obfuscate itself. Give the flag located in Kerberos’ registry subkey.

HINT: Use Sysinternals tools.

    Machine: Workstation1 (RDP from Admin-Station)
        login: student
        password: password


Use regedit to find Computer\HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Kerberos\Parameters
Make sure your in this exact directory

Flag is: 76aGreX5




Windows_Hidden_Processes_5


There is malware named TotallyLegit. Find its binary location and there will be a file in that directory. Read the file.

HINT: Use Sysinternals tools.
Use autoron to find the directory go there and read the txt file

GwlkK3sa

Windows_Hidden_Processes_6

Find the McAfeeFireTray.exe. There is a file in that directory. The flag is inside.

HINT: Use Sysinternals tools.

    Machine: Workstation1 (RDP from Admin-Station)
        login: student
        password: password


Same shit as last question

StrongBad



Windows_Hidden_Processes_7
A nonstandard port has been opened by possible malware on the system. Identify the port.

    Machine: Workstation1 (RDP from Admin-Station)
        login: student
        password: password




6666







Win_Process_Situational_Awareness_1


What are the permissions for NT SERVICE\TrustedInstaller on spoolsv.exe? Copy the permissions from your shell.

HINT: Use Sysinternals tools.

run cmd as admin
Cd to folder containting accesschck
run this command .\accesschk.exe C:\Windows\System32\spoolsv.exe


RW


Win_Process_Situational_Awareness_2



What is the PATH listed in the output when we find the handle for spoolsv.exe?

HINT: Use Sysinternals tools and don't forget to run as Administrator...

cd to sysinternal folder
use tool handle like this
.\handle -p spoolsv
Output:
C:\Windows\System32\en-US\spoolsv.exe.mui













Win_Process_Situational_Awareness_3


In what Load Order Group is the Windows Firewall service?

HINT: Use Sysinternals tools.

use loadorder tool and look for it 

Network Provider



Win_Process_Situational_Awareness_4






What is the first .dll associated with winlogon.exe? Provide the name of the .dll only, not the /absolute/path

HINT: Use Sysinternals tools.


go to proc exporer crtl f winlogon go to strings and crlt f dll
ntdll.dll


Win_Process_Situational_Awareness_5


While examining the Windows Defender Firewall, what is the LogAllowedConnections setting set to, for the Public profile?


run this cmd :
netsh advfirewall show publicprofile logging


disable

Windows_Hidden_Processes_7

A nonstandard port has been opened by possible malware on the system. Identify the port.

    Machine: Workstation1 (RDP from Admin-Station)
        login: student
        password: password








Windows_UAC_Basics_1
What Sysinternals tool will allow you to view a file's manifest?

Sigcheck

Windows_UAC_Basics_2
What is the RequestedExecutionLevel for an application to run with the same permissions as the process that started it?

asInvoker




Windows_UAC_Basics_3
What RequestedExecutionLevel will prompt the user for Administrator credentials if they're not a member of the Administrator's group?


requireAdministrator




Windows_UAC_Basics4
What registry key holds UAC values?

HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System


Windows_UAC_Basics5



The flag is the RequestedExecutionLevel of the schtasks.exe file.

 I just guesed
asInvoker


Windows_UAC_Basics_6
Determine which UAC subkey property shows whether UAC is enabled or not. The flag is the data value in that property.

Hint: Make sure you're on the file-server.
 
reg query HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System
Check under EnableLua value


0x1337



Windows_UAC_Basics_7



Provide the name of the UAC [Registry subkey] property that determines what level UAC is set to for admin privileges (Example UAC levels: Default, Always, Notify).


reg query HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System

ConsentPromptBehaviorAdmin


Windows_UAC_Basics_8

Query the registry subkey where UAC settings are stored, and provide the flag.


reg query HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System


NiceJob



Windows_Services_Basics_1




What command-line (cmd) command will show service information?


sc




Windows_Services_Basics_2


What command-line (cmd) command will show all services, running or not running?

The flag is the full command, for all services.



sc query state= all




Windows_Services_Basics_3

What PowerShell command will list all services?


Get-Service




Windows_Services_Basics_4

What registry location holds all service data?


HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services




Windows_Services_Basics_5

What registry subkey holds a service's .dll location?

The flag is the subkey name (full path not needed).

Parameters




Windows_Services_Basics_6


Services have a name and display name, which could be different. What is the service name of the only Totally-Legit service?

Reminder: All challenges are done using the file-server.

Get-Service | Where-Object { $_.DisplayName -eq "Totally-Legit" }

Legit



Windows_Services_Basics_7




Figure out the SID of the only Totally-Legit service.

Example: S-1-5-80-159957745-2084983471-2137709666-960844832-[4182961472]

Submit only the [bracketed] portion of the SID.

HINT: Run the command on the service name, not the display name.

sc.exe showsid Legit


1182961511



-----------------------------------------------------------------------------------------------------------------------------Day 7----------------------------------------------------------------------------------------------------


Linux Processes 1
What is the process ID (PID) of the SysV Init daemon?

pgrep init

1



Linux Processes 2

How many child processes did SysV Init daemon spawn?


pstree -p 1

21



Linux Processes 3

Identify all of the arguments given to the ntpd daemon (service) using ps.

Format: List all options with parameters (include numbers).

ps -p $(pgrep ntpd) -o args=

-p /var/run/ntpd.pid -g -u 105:109


Linux Processes 4


What is the parent process to Bombadil’s Bash process? (name of the binary, not the absolute path)

pgrep -u bombadil bash
31204

ps -o comm= -p $(ps -o ppid= -p 31204)
sshd


Linux Processes 5
Identify the file mapped to the fourth file descriptor (handle) of the cron process.

HINT: There might be multiple cron processes, but only one with the answer.

Flag format: /absolute/path

pgrep cron
1346

sudo ls -lisa /proc/1346/fd/3

/run/crond.pid



Linux Processes 6
Identify the permissions that cron has on the file identified in Processes 5.

HINT: Read the man page for lsof to understand permissions.

Flag format: If more than one, list the permissions comma separated, no spaces

r,w


Linux Processes 7

Identify the names of the orphan processes on the SysV system.

NOTE: Remember, orphan processes spawn and die periodically. Try monitoring the processes list with top or htop to find them.

Flag format: in alphabetical order with all non-alphabetic characters removed: Name,Name,Name,Name

HINT: Only character names!

Aragorn,BruceWayne,Eowyn,Tolkien



Linux Processes 8

Locate zombie processes on the SysV system.

Identify the zombie processes' parent process.

NOTE: Remember, zombie processes only live until the parent process kills and removes them from the system’s process table. Try monitoring the processes list with top or htop to find them.

Flag format: /absolute/path


/bin/funk





Linux Processes 9

Locate the strange open port on the SysV system.

Identify the command line executable and its arguments.

Flag format: /executable/path -arguments



ps aux

/bin/netcat -lp 9999














Linux Process Proc Dir 1


Examine the process list to find the ssh process. Then, identify the symbolic link to the absolute path for its executable in the /proc directory.

The flag is the absolute path to the symbolic link, and the file it is linked to.

Flag format: /absolute/path,/absolute/path

pgrep ssh 
cd /proc
cd /proc/2001
sudo ls -lisa | grep exe

/proc/2001/exe,/usr/sbin/sshd




Linux Process Proc Dir 2

Identify the file that contains udp connection information. Identify the process using port 123.

For the flag, enter:

    Process name
    File descriptor number for the udp socket
    Its permissions as shown in lsof

Flag format: name,#,permission

sudo lsof -iUDP


COMMAND   PID USER   FD   TYPE DEVICE SIZE/OFF NODE NAME
dhclient 1077 root    5u  IPv4  11347      0t0  UDP *:bootpc
dhclient 1112 root    5u  IPv4  10989      0t0  UDP *:bootpc
ntpd     1465  ntp   16u  IPv6  11602      0t0  UDP *:ntp
ntpd     1465  ntp   17u  IPv4  11605      0t0  UDP *:ntp
ntpd     1465  ntp   18u  IPv4  11610      0t0  UDP localhost:ntp
ntpd     1465  ntp   19u  IPv4  11612      0t0  UDP 10.9.0.7:ntp
ntpd     1465  ntp   20u  IPv6  11614      0t0  UDP ip6-localhost:ntp
ntpd     1465  ntp   21u  IPv6  11616      0t0  UDP [fe80::f816:3eff:fec2:a3c5]:ntp



this is the important line ntp is asummed to use port 123.
ntpd     1465  ntp   17u  IPv4  11605      0t0  UDP *:ntp


Heres the answer
ntpd,17,u














Linux Processes 10


Locate the strange open port on the SysV system.

Identify how the process persists between reboots.

The flag is the absolute path for the file that contains the persistence mechanism, and the configuration option.

HINT: Persistence is defined here

Flag format: filepath,configuration_option

 netstat -tuln | grep LISTEN
cd /etc
ls
cat inittab

path of inittab,91:2345:respawn:/bin/netcat -lp 9999 

/etc/inittab,91:2345:respawn:/bin/netcat -lp 9999



Linux Process Proc Dir 3


Identify one of the human-readable file handles by the other program that creates a zombie process.

NOTE: Remember, zombie processes only live until the parent process kills them. Try monitoring the processes list with top or htop to find them.

The flag is the text from one of the files it reads.




Linux Process Find Evil 1


    Scenario: The Villains group has been chanting offerings to their new leader at regular intervals over a TCP connection.

    Task: Identify their method of communication and how it is occurring. Locate the following artifacts: ** The chant/text used by each villain (include spaces) ** The new Lord receiving the offering ** The IP address and port that the offering is received over

    Flag format: chant text,new Lord,IP:port

    Machine: Minas_Tirith





------------------------------------------------------------------------------------------------Day 8------------------------------------------------------------------------------------------------------------------------------------------
Primer_Auditing_1


Logging, Auditing and Monitoring are often confused with each other but are distinctly different. Which term refers to real-time analysis and is often accomplished with a Security Event Information Management system (SIEM)?


Monitoring




Primer_Auditing_2

What term is most appropriate when referring to the process of reviewing log files or other records for specified period?


Auditing





Primer_Auditing_3

"Complete the following path to the Windows System Log which records system events e.g. startup and shutdown: %systemroot%\System32_______________

Resource: https://os.cybbh.io/public/os/latest/011_windows_auditing_&_logging/primer.html#_8_describe_the_systems_event_logs



\WinEvt\Logs\System.evtx


Primer_Auditing_4

Which Windows log contains either success or failures and can be configured to record failed logon attempts?


Security


Primer_Auditing_5

"Which Windows account is the only account to have WRITE-APPEND access to Windows event logs?"

Resource: https://os.cybbh.io/public/os/latest/011_windows_auditing_&_logging/primer.html#_7_describe_the_systems_audit_policy



NT AUTHORITY\SYSTEM



Primer_Auditing_6


What is parsed in an NTFS object's security descriptor, by the Security Reference Monitor (SRM), to determine if an audit entry will be created in the Windows Security Log?

Research: https://learn.microsoft.com/en-us/windows/win32/secauthz/access-control-lists


SACL


Primer_Auditing_7

Which registry key holds the audit policy configuration? **Hint - Give full path




Primer_Auditing_8
Which sysinternals tool is used to parse logs?

psloglist



Windows_Browser_Artifacts_1
What Sysinternals tool will allow you to read the SQLite3 database containing the web history of chrome?











Windows_Recent_Files_1


What is the registry location of recent docs for the current user?


HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs





Windows_Last_Access
Figure out the last access time of the hosts file.

Flag format: mm/dd/yyyy



06/04/2024


Windows_Prefetch_1
What is the literal path of the prefetch directory?

C:\Windows\Prefetch



Windows_Recycle_Bin_1

In the Recycle Bin, there is a file that contains the actual contents of the recycled file. What are the first two characters of this filename?

$R


Windows_Recycle_Bin_2
In the Recycle Bin, there is a file that contains the original filename, path, file size, and when the file was deleted. What are the first two characters of this filename?

$I



Windows_UserAssist_1
What are the first 8 characters of the Globally Unique Identifier (GUID) used to list applications found in the UserAssist registry key (Windows 7 and later)?


CEBFF5CD




Windows_UserAssist_2
What cipher method are UserAssist files encoded in?

ROT13



Windows_Logs_1
What main Windows log would show invalid login attempts?

Security






Windows_Logs_2
What main Windows log will show whether Windows updates were applied recently?



Windows_Logs_3
When reading logs, you may notice ... at the end of the line where the message is truncated. What format-table switch/argument will display the entire output?

Flag format: -argument

-wrap





Windows_Browser_Artifacts_2
Find the questionable website that a user browsed to (using Chrome), that appears to be malicious. *Note: There are more than one users on the box.

Machine: Workstation2 (ssh from Admin_Station)

$History = (Get-Content 'C:\users\student\AppData\Local\Google\Chrome\User Data\Default\History') -replace "[^a-zA-Z0-9\.\:\/]",""
$History

https://www.exploitdb.com/




Windows_Recent_Files_2


There is a file that was recently opened that may contain PII.

Get the flag from the contents of the file.

Hint: We're not interested in numbers.


Get-Item "REGISTRY::HKEY_USERS\*\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs\.txt" | select -Expand property | ForEach-Object {
    [System.Text.Encoding]::Default.GetString((Get-ItemProperty -Path "REGISTRY::HKEY_USERS\*\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs\.txt" -Name $_).$_)
}   




Flag, Found A.





Windows_Bam_2

Enter the full path of the program that was run on this computer from an abnormal location.




Windows_Prefetch_2
Enter the name of the questionable file in the prefetch folder.


BAD_INTENTIONS.EXE-8F2806FC.pf




Windows_Prefetch_3
What is the creation time of the questionable file in the prefetch folder?

Flag format: mm/dd/yyyy

dir BAD_INTENTIONS.EXE-8F2806FC.pf

02/23/2022




Windows_Recycle_Bin_3

Recover the flag from the Recycle Bin. Enter the name of the recycle bin file that contained the contents of the flag, and the contents of the deleted file. Include the file extension in your answer.

*Hint: "Don't"

Flag format: filename,contents


$RZBV370.txt,DontTrashMeyo


Windows_Jump_Lists
Find the file in the jump list location that might allow privilege escalation.
UIDPWD.txt

-----------------------------------------------------------------------------------------------------------Day 9-------------------------------------------------------------------------------------------

Linux Auditing and Logging XML 1


File: /home/garviel/output.xml

Identify the XML element name in the output below


<scaninfo type="syn" protocol="tcp" numservices="200" services="1-200"/>



Flag: The element with start and end tags


scaninfo





Linux Auditing and Logging XML 2




Identify one of the XML attributes in the output below


<scaninfo type="syn" protocol="tcp" numservices="200" services="1-200"/>



Flag format: value="pair"


protocol="tcp"




Linux Auditing and Logging Standards 1



What RFC is Syslog?



RFC 5424







Linux Auditing and Logging Standards 2





Challenge only allows 3 attempts

What is the numerical code assigned to the facility dealing with authorization?


4




Linux Auditing and Logging Standards 3




Challenge only allows 3 attempts

How many severity codes are defined in the standard that defines syslog?




8



Linux Auditing and Logging Standards 4


Challenge only allows 3 attempts

What severity is assigned to system instability messages?

Hint: Use the numerical code!





0



Linux Auditing and Logging Syslog 1



Challenge only allows 3 attempts

Download the attached rsyslog configuration file for the Syslog # challenges.

In the legacy rules section of the file, what facility is logged to 0.log?


0


Linux Auditing and Logging Syslog 2



In the legacy rules section of the file, how many severities are logged to 0.log?

Flag: Total number of severities


8


Linux Auditing and Logging Syslog 3


In the legacy rules section of the file, how many severities are logged to 4min.log?

List the severities from highest severity (lowest numerical listed) to lowest severity (highest numerical listed) using their severity name.

Flag format: name,name,name



emergency,alert,critical,error,warning







Linux Auditing and Logging Syslog 4

In the legacy rules section of the file, how many severities are logged to 4sig.log?

List the severities from highest severity (lowest numerical listed) to lowest severity (highest numerical listed), using their severity name.

Flag format: name,name,name

Hint: I’m sure they made a man page for this. Read the downloaded file for some links.



Notice,Informational,Debug





Linux Auditing and Logging Syslog 5




Challenge only allows 3 attempts

What is being logged in not.log?

Provide the facilities from lowest facility to highest facility numerically, and the severity being logged. (List only the first word for each.)

Flag format: facility,facility,facility,severity


mail,clock,NTP,notice




Linux Auditing and Logging Syslog 6


Challenge only allows 3 attempts

What facilities and what severities are being sent to a remote server over a reliable connection using port 514?

Provide the facility names, number of severities, and the correct destination IP address.

Flag format: F,F,#,IP



auth,authpriv,8,10.30.0.1



Linux Auditing and Logging Syslog 7


Challenge only allows ONE attempt

Use the answer from Syslog 6 for this question.

Do logs that match this filter ever get saved on the local machine?
Yes
No



Idk Yes I think?



Linux Auditing and Logging Syslog 8


What messages are being sent to 10.84.0.1?

Provide the facility number, the number (amount) of severity codes, and Layer 4 connection type as the answer.

Flag format: F,S,Layer 4 connection Type

0,7,UDP



Linux Auditing and Logging Whut 1

Use the log file attached to this for all Whut questions.

How many unique users logged into this machine?

3 



Linux Auditing and Logging Whut 3

Identify the Cyber Attack Technique that Balrog is trying on the machine.

HINT: https://attack.mitre.org/


Credential Access




------------------------------------------------------------------------------------------------------------Day 10----------------------------------------------------------------------------------------
Primer_Networking_1
What is used in Windows to implement the networking stack to enable communication with the four lowest OSI layers?

Research: https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-2000-server/cc958797(v=technet.10)?redirectedfrom=MSDN



Network Driver Interface Specification






Primer_Networking_2



What Windows cmd.exe command will display the local computer's routing table?

Research: https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/netstat


route print





Primer_Networking_3

IANA assigned TCP/UDP ports in the range of 0-1023 that are usually associated with server-side services are known as?

Research: https://networkencyclopedia.com/well-known-port-numbers/



well-known ports




Primer_Networking_4



What term describes randomly assigned TCP/UDP ports above 1023 and are used for a short period of time (for the duration of a communication session}?

Research: https://en.wikipedia.org/wiki/Ephemeral_port




ephemeral ports




Primer_Networking_5

The two words that decribe translating Host names to IP addresses or NetBIOS names to IP addresses is_____?

Research: https://learn.microsoft.com/en-us/windows/win32/dns/name-resolution



name resolution


Primer_Networking_6



What is the hierarchical service/protocol that translates hostnames to IP addresses?

Research: https://learn.microsoft.com/en-us/windows/win32/dns/dns-overview


DNS


Primer_Security_1

What is the term for the numeric value that the Windows OS uses to uniquely ID a user, group or computer?

security identifier



Primer_Security_2

What switch can be added to the CMD.exe command whoami, to view the SID of the current user?

Research: https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/whoami


/user



Primer_Security_3

What is the value of a Relative Identifier (RID) assigned to the 1st user account?

Research: https://os.cybbh.io/public/os/latest/013_memory_analysis/primer.html#_4_associate_a_user_sid_with_a_user_profile



1000


Primer_Security_4

What is the well known RID for the Windows Built-In Administrator Local account?

Research: https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-dtyp/81d92bba-d22b-4a8c-908a-554ab29148ab



500





Primer_Security_5

Complete the GET_CimInstance cmdlet to view all the user SIDs on a Windows host machine by Name and SID respectively:

Get-CimInstance Win32_UserAccount | Select-Object ______________

**hint: the output will ONLY include Name and SID



Name, SID



Primer_Security_6


In Windows what else does a user's security Token contain?

    SIDS of groups of which the user is a member
    Privilege array
    The Users _________ ?

**hint: Flag describes the unique number assigned to the user

Research: https://os.cybbh.io/public/os/latest/013_memory_analysis/primer.html#_1_1_security_identifiers_sids


SID




Primer_Security_7

When contained in a Windows users access token, what privilege does SeBackupPrivilege grant to the user to perform on files and folders?

**hint - flag is one word

Research: https://learn.microsoft.com/en-us/windows-hardware/drivers/ifs/privileges

backup




Primer_Security_8

Windows performs mandatory integrity checks (MICs) by comparing the integrity level of the resource with the integrity level of the calling process. Windows does this integrity check before the the objects discretionary access check because it is _____________?

Research: https://learn.microsoft.com/en-us/windows/win32/secauthz/mandatory-integrity-control

Hint: Opposite of slower



Faster


Primer_Security_9

A Windows object's Security _________ contains:

    The SID of the object's owner
    Discretionary Access Control List (DACL)
    System Access Control List (SACL)

Research: https://learn.microsoft.com/en-us/windows/win32/secauthz/security-descriptors


Descriptor



Primer_Security_10

What contains Access Control Entries (ACEs), that define the types of access a user or group may be granted to an object?

Research: https://learn.microsoft.com/en-us/windows/win32/secauthz/access-control-lists



DACL





Primer_Security_11

What cmdlet gets objects that represent the security descriptor of a file or resource?

Research: https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.security/get-acl?view=powershell-7.2



Get-Acl




Primer_Security_12

What NET cmd.exe command can be used to enumerate the local Windows group accounts?

Research: https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/cc725622(v=ws.11)


Net localgroup





Primer_Security_13



Read and answer

https://ss64.com/nt/icacls.html

What Windows cmd.exe command will display or modify Access Control Lists (ACLs) for files and folders and resolves various issues that occur when using the older CACLS & XCACLS.


ICACLS


Primer_Security_14



Read and answer:

https://learn.microsoft.com/en-us/windows/win32/memory/data-execution-prevention

What Windows security feature is a system-level memory protection feature that is built into the operating system starting with Windows XP and Windows Server 2003 and enables the system to mark one or more pages of memory as non-executable?


Data Execution Prevention






Primer_Security_15




What computer security technique is used in Windows to prevent exploitation of memory corruption vulnerabilities? This feature randomly arranges the address space positions of key data areas of a process, in order to prevent an attacker from reliably jumping to, a particular exploited function in memory.

Research: https://www.mandiant.com/resources/blog/six-facts-about-address-space-layout-randomization-on-windows


Address Space Layout Randomization



Primer_Security_16

What is a small kernel-mode library that can implement API hooking?

Research: https://techcommunity.microsoft.com/t5/ask-the-performance-team/demystifying-shims-or-using-the-app-compat-toolkit-to-make-your/ba-p/374947


Shim



Primer_Security_17






Read and Answer the next 4 challenges regarding Windows security features introduced in Windows 10 Creator's Update (Windows 10, version 1703)

https://learn.microsoft.com/en-us/windows/security/threat-protection/overview-of-threat-mitigations-in-windows-10

    Which security feature helps keep attackers from gaining access through Pass-the-Hash or Pass-the-Ticket attacks using virtualization-based security to isolate secrets, such as NTLM password hashes and Kerberos Ticket Granting Tickets?




Credential Guard



Primer_Security_18


    Introduced in Windows 8 this is Microsoft Antivirus, anti-malware solution?

Research: https://www.microsoft.com/en-us/windows/comprehensive-security




Windows Defender



Primer_Security_19




    What security technique helps prevent overwrites of the Structured Exception Handler?

Research: https://support.microsoft.com/en-us/topic/how-to-enable-structured-exception-handling-overwrite-protection-sehop-in-windows-operating-systems-8d4595f7-827f-72ee-8c34-fa8e0fe7b915




SEHOP

Primer_Security_20



    What security protection is built into Windows 10, as described in the "Memory reservations" item in Kernel pool protections? This includes protecting address space 0x00000000 (not listed in article).

Hint: what is 0? Research: https://learn.microsoft.com/en-us/windows/win32/memory/reserving-and-committing-memory

NULL



Primer_Security_21


Read and answer: https://learn.microsoft.com/en-us/windows/win32/wfp/windows-resource-protection-portal

What Windows security feature prevents the replacement of essential system files, folders, and registry keys that are installed as part of the operating system? It became available starting with Windows Server 2008 and Windows Vista.


WRP



Primer_Security_22

Read and answer: https://support.microsoft.com/en-us/topic/use-the-system-file-checker-tool-to-repair-missing-or-corrupted-system-files-79aa86cb-ca52-166a-92a3-966e85d4094e

What option should you use with the System File Checker cmd.exe tool sfc.exe to scan all protected system files, and replace corrupted files with a cached copy that is located in a compressed folder at %WinDir%\System32\dllcache ?


/scannow


Primer_Security_23


Where are copies of known-good critical system files located at %WinDir%___________ and used by the Windows Resource Protection feature?

hint: complete the path

Research: https://en.wikipedia.org/wiki/Windows_Resource_Protection https://learn.microsoft.com/en-us/windows-hardware/manufacture/desktop/clean-up-the-winsxs-folder?view=windows-11


\WinSxS\Backup



Primer_Networking_7



What CLI tool is often used to troubleshoot DNS issues but can also be used in reconnaissance?

Research: https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/nslookup



nslookup

Primer_Networking_8


In Windows 10 what is the full path to the hosts file? Complete the path c:\Windows____________

Research: https://www.tenable.com/plugins/nessus/23910


System32\drivers\etc\hosts



Primer_Networking_9


Fill in the missing component for the usual Host Name Resolution order:

    Client checks own host name
    Client searches local Hosts file
    ______________________
    NetBIOS name resolution sequence is used as a backup

Flag Format: Full name or acronym

Research: https://learn.microsoft.com/en-us/windows/win32/dns/dns-overview https://support.microsoft.com/en-us/topic/microsoft-tcp-ip-host-name-resolution-order-dae00cc9-7e9c-c0cc-8360-477b99cb978a



Domain Name System







Primer_Networking_10

What cmd.exe tool will display NetBIOS transport statistics in Windows?

Research: https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/nbtstat



nbtstat

Primer_Surveys_1



What team survey is focused on security and auditing?

______ Team

Research: https://www.coursera.org/articles/red-team-vs-blue-team


Red

Primer_Surveys_2



What type of survey is focused on computer system settings, updates, configurations and installed software?

________ Team

Research: https://ine.com/blog/understanding-blue-team-roles

blue




Primer_Surveys_3

What type of survey is focused on malware detection, artifact detection and investigating processes?

Research: https://learn.microsoft.com/en-us/security/compass/incident-response-overview


Incident response


Windows_Memory_Analysis_Plugin_1

What Volatility plugin will dump a process to an executable file sample?



procdump


Windows_Memory_Analysis_Plugin_2
What Volatility plugin will extract command history by scanning for _COMMAND_HISTORY?

cmdscan


Windows_Memory_Analysis_Plugin_3
What Volatility plugin will show driver objects?

driverscan

Windows_Memory_Analysis_Basics_1
What plugin do you run to find which memory profile to use with a memory image?

imageinfo



Windows_Memory_Analysis_Basics_2
What switch/argument will list all plugins for Volatility?

-h

Windows_Volatility_Data
In terms of Volatile Data, what locations are the MOST volatile?

Flag format: location,location

CPU registers,cache



Windows_Memory_Analysis_Basics_3
What is the 12th plugin listed in the Volatility help menu?


.\volatility_2.6_win64_standalone.exe -h

cmdscan




Windows_Memory_Analysis_Basics_4


What profile do you use in conjunction with this memory image?

Use the following file (memory image) to answer the rest of the Memory Analysis challenges.

0zapftis.vmem



.\volatility_2.6_win64_standalone.exe -f .\0zapftis.vmem imageinfo

WinXPSP2x86


Windows_Malware_1
What command did the attacker type to check the status of the malware?

.\volatility_2.6_win64_standalone.exe -f .\0zapftis.vmem  --profile=WinXPSP2x86 cmdscan

sc query malware



Windows_Malware_2

What are the last 7 digits of the memory offset for the driver used by the malware?

.\volatility_2.6_win64_standalone.exe -f .\0zapftis.vmem  --profile=WinXPSP2x86  driverscan
1a498b8 (far left column)




Windows_Malware_3
The process running under PID 544 seems malicious. What is the md5hash of the executable?


run cmd as admin
Set-MpPreference -ExclusionPath "C:\Users\student\Desktop"
.\volatility_2.6_win64_standalone.exe -f .\0zapftis.vmem  --profile=WinXPSP2x86 procdump -p 544 -D .
Get-FileHash -Path "C:\Users\student\Desktop\executable.544.exe" -Algorithm MD5

6CEE14703054E226E87A963372F767AA





Windows_Malware_4

What remote IP and port did the system connect to?

Flag format: ip:port


 .\volatility_2.6_win64_standalone.exe -f .\0zapftis.vmem  --profile=WinXPSP2x86 connscan

172.16.98.1:6666





Primer_Active_Directory_1
What is the database that is used to connect users with network resources?

Resources https://os.cybbh.io/public/os/latest/014_windows_active_directory_enumeration/primer.html

Active Directory


Primer_Active_Directory_2
What are all things that are in active directory stored as?

Resources https://os.cybbh.io/public/os/latest/014_windows_active_directory_enumeration/primer.html#_1_1_active_directory_structure

objects


Primer_Active_Directory_3
What is the Active Directory component which contains formal definitions of every object class that can be created in an Active Directory forest?

Resources https://os.cybbh.io/public/os/latest/014_windows_active_directory_enumeration/primer.html#_3_domains


Schema



Primer_Active_Directory_4


What protocol is used when accessing and updating the Active Directory?

Resources https://www.sciencedirect.com/topics/computer-science/directory-access-protocol

LDAP

Primer_Active_Directory_5


From an Offensive perspective, what type of account is usually the main target?

Resources https://os.cybbh.io/public/os/latest/014_windows_active_directory_enumeration/primer.html#_7_administrator_best_practices

Administrator




Primer_Active_Directory_6

Task : If an account has been inactive for a substantial amount of time what should the adminstrators do to the account?

Resources https://os.cybbh.io/public/os/latest/014_windows_active_directory_enumeration/primer.html#_11_impact_of_group_policy_settings



disable






Primer_Active_Directory_7

What is the basic PowerShell cmdlet used to enumerate users?

Resources https://os.cybbh.io/public/os/latest/014_windows_active_directory_enumeration/primer.html#_2_2_powershell

Get-ADUser



Primer_Active_Directory_8



What is the suite of tools used in CLI to enumerate users across the network?

Resource


DS



Windows_Active_Directory_Basics1


What is the domain portion of the following SID:

S-1-5-21-1004336348-1177238915-682003330-1000


21-1004336348-1177238915-682003330





Windows_Active_Directory_Basics2

What PowerShell command will list domain groups?

Get-ADGroup



Windows_Active_Directory_Basics3

What PowerShell command will list all users and their default properties?

The flag is the full command with arguments.


Get-ADUser -Filter * 




Windows_Active_Directory_Basics4
What PowerShell command will allow you to search Active Directory accounts for expired accounts without having to create a filter?

The flag is only the command, no arguments/switches.


Search-ADAccount



Windows_AD_Search_Accounts
Find the expired accounts that aren't disabled. List the last names in Alphabetical Order, separated with a comma, and no space between.

Flag format: name,name

Reminder: All challenges are done using the Domain-Controller

Search-ADAccount -AccountExpired -UsersOnly | Where-Object { $_.Enabled -eq $true }


Krause,Page



Windows_AD_Search_Emails
Find the unprofessional email addresses. List the email's domain.


Get-ADUser -Filter {EmailAddress -like "*"} -Properties EmailAddress | Select-Object -ExpandProperty EmailAddress


then use regex to find the emails that stand out
^(?!.*\b[A-Za-z]+\.[A-Za-z]+\.mil@mail\.mil\b).*$



ashleymadison.com




Windows_AD_Search_Files
The flag is the unprofessionally-named file located somewhere on the Warrior Share.

Connect to the Warrior Share:

net use * "\\file-server\warrior share"


cd Z:

Get-ChildItem -Path "Z:\" -File -Recurse

lulz.pdf





Windows_AD_Search_Insider_1


The flag is the name of the file, where in the file contents, someone is requesting modified access rights.

Connect to the Warrior Share:

net use * "\\file-server\warrior share"


14287.pdf



Windows_AD_Search_Insider_2

The flag is the name of the user who is requesting modified access rights.

Connect to the Warrior Share:

net use * "\\file-server\warrior share"

Hint: Complete Windows_AD_Search_Insider_1 first.

 336-6754
